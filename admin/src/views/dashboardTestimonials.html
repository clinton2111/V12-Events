<div ng-init="fetchTestimonials(0)">
    <div class="container">
        <h1 class="header red-text thin">Testimonials</h1>

        <div class="section">
            <div ng-repeat="testimonial in testimonials" ng-if="$index % 3 == 0" class="row col s12 m12 l12">
                <div class="col s12 m4 l4" ng-if="testimonials[$index]">

                    <div class="card blue-grey darken-1">
                        <div class="card-content white-text">
                            <blockquote>{{testimonials[$index].testimonial}}</blockquote>
                            <p>{{testimonials[$index].testifier_name}}<span
                                    ng-show="testimonials[$index].testifier_designation || testimonials[$index].testifier_company_name"> - {{testimonials[$index].testifier_designation}}, {{testimonials[$index].testifier_company_name}}</span>
                            </p>
                        </div>
                        <div class="card-action">
                            <a ng-click="openModal(testimonials[$index].id,'update_testimonial')">Edit</a>
                            <a ng-click="deleteTestimonial(testimonials[$index].id)">Delete</a>
                            <span class="right-align">

                                    <input type="checkbox" id="show_on_site{{$index}}"
                                           ng-checked="checkChecked(testimonials[$index].id)"
                                           ng-click="updateSoS(testimonials[$index].id)"/>
                                    <label for="show_on_site{{$index}}" class="amber-text">Show on Site</label>

                            </span>
                        </div>
                    </div>

                </div>

                <div class="col s12 m4 l4" ng-if="testimonials[$index+1]">

                    <div class="card blue-grey darken-1">
                        <div class="card-content white-text">
                            <blockquote>{{testimonials[$index+1].testimonial}}</blockquote>
                            <p>{{testimonials[$index+1].testifier_name}}<span
                                    ng-show="testimonials[$index+1].testifier_designation || testimonials[$index+1].testifier_company_name"> - {{testimonials[$index+1].testifier_designation}}, {{testimonials[$index+1].testifier_company_name}}</span>
                            </p>
                        </div>
                        <div class="card-action">
                            <a ng-click="openModal(testimonials[$index+1].id,'update_testimonial')">Edit</a>
                            <a ng-click="deleteTestimonial(testimonials[$index +1].id)">Delete</a>
                            <span class="right-align">

                                    <input type="checkbox" id="show_on_site{{$index+1}}"
                                           ng-checked="checkChecked(testimonials[$index+1].id)"
                                           ng-click="updateSoS(testimonials[$index+1].id)"/>
                                    <label for="show_on_site{{$index+1}}" class="amber-text">Show on Site</label>

                            </span>
                        </div>
                    </div>

                </div>

                <div class="col s12 m4 l4" ng-if="testimonials[$index+2]">

                    <div class="card blue-grey darken-1">
                        <div class="card-content white-text">
                            <blockquote>{{testimonials[$index+2].testimonial}}</blockquote>
                            <p>{{testimonials[$index+2].testifier_name}}<span
                                    ng-show="testimonials[$index+2].testifier_designation || testimonials[$index+2].testifier_company_name"> - {{testimonials[$index+2].testifier_designation}}, {{testimonials[$index+2].testifier_company_name}}</span>
                            </p>
                        </div>
                        <div class="card-action">
                            <a ng-click="openModal(testimonials[$index+2].id,'update_testimonial')">Edit</a>
                            <a ng-click="deleteTestimonial(testimonials[$index+2].id)">Delete</a>
                            <span class="right-align">

                                    <input type="checkbox" id="show_on_site{{$index+2}}"
                                           ng-checked="checkChecked(testimonials[$index+2].id)"
                                           ng-click="updateSoS(testimonials[$index+2].id)"/>
                                    <label for="show_on_site{{$index+2}}" class="amber-text">Show on Site</label>

                            </span>

                        </div>


                    </div>

                </div>


            </div>

            <div ng-show="testimonials.length!=0">
                <div class="center"><a class="waves-effect waves-light btn blue-grey" ng-click="loadMore()">Load More
                    Testimonials</a></div>
            </div>
            <div ng-show="testimonials.length==0">
                <p class="flow-text">No Testimonials Found</p>
            </div>


            <div class="fixed-action-btn" style="bottom: 45px; right: 24px;">
                <a class="btn-floating btn-large red z-depth-3 modal-trigger"
                   ng-click="openModal(null,'new_testimonial')">
                    <i class="material-icons">person_add</i>
                </a>
            </div>

        </div>

    </div>


    <div id="new_testimonial_modal" class="modal">
        <form class="col s12" ng-submit="uploadTestimonial()">
            <div class="modal-content">
                <h4>Create New Testimonial</h4>

                <div class="row">
                    <div class="input-field col s12">
                        <textarea id="n_testimonial" class="materialize-textarea"
                                  ng-model="new_testimonial.testimonial" required="true"></textarea>
                        <label for="n_testimonial">Enter Testimonial </label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12 m4 l4">
                        <input id="n_name" type="text" class="validate" ng-model="new_testimonial.testifier_name" required="true">
                        <label for="n_name">Testifier Name</label>
                    </div>
                    <div class="input-field col s12 m4 l4">
                        <input id="n_designation" type="text" class="validate"
                               ng-model="new_testimonial.testifier_designation" required="true">
                        <label for="n_designation">Testifier Designation</label>
                    </div>
                    <div class="input-field col s12 m4 l4">
                        <input id="n_company_name" type="text" class="validate"
                               ng-model="new_testimonial.testifier_company_name" required="true">
                        <label for="n_company_name">Company Name</label>
                    </div>
                </div>
                <div class="row">
                    <p class="col s12 m4 l4">
                        <input type="checkbox" id="n_show" ng-model="new_testimonial.show_on_site"/>
                        <label for="n_show">Show on site</label>
                    </p>
                </div>


            </div>
            <div class="modal-footer">
                <button class="modal-action  btn-flat waves-effect waves-light " type="submit">Create

                </button>
                <button type="button" class="modal-action modal-close btn-flat waves-effect waves-light ">Close

                </button>
            </div>
        </form>
    </div>

    <div id="update_testimonial_modal" class="modal">
        <form class="col s12" ng-submit="updateTestimonial(tempData.id)">
            <div class="modal-content">
                <h4>Update Testimonial</h4>


                <div class="row">
                    <div class="input-field col s12">
                        <textarea id="update_testimonial" class="materialize-textarea"
                                  ng-model="tempData.testimonial" required="true"></textarea>
                        <label for="update_testimonial">Enter Testimonial </label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12 m4 l4">
                        <input id="update_name" type="text" class="validate" ng-model="tempData.testifier_name">
                        <label for="update_name">Testifier Name</label>
                    </div>
                    <div class="input-field col s12 m4 l4">
                        <input id="update_designation" type="text" class="validate"
                               ng-model="tempData.testifier_designation">
                        <label for="update_designation">Testifier Designation</label>
                    </div>
                    <div class="input-field col s12 m4 l4">
                        <input id="update_company_name" type="text" class="validate"
                               ng-model="tempData.testifier_company_name">
                        <label for="update_company_name">Company Name</label>
                    </div>
                </div>


            </div>
            <div class="modal-footer">
                <button type="submit" class="modal-action  btn-flat waves-effect waves-light ">
                    Update

                </button>
                <button type="button" class="modal-close btn-flat waves-effect waves-light ">Close
                </button>
            </div>
        </form>
    </div>
</div>